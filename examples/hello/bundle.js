var te={},tn={layout:"row",visible:!0},C=(e,n,l={})=>{te[e]={...tn,...l,component:n}},ze=e=>e in te?!0:(console.warn(`control of type "${e}" is requested but not registered`),!1),ln=e=>{if(!ze(e.type))return;let{component:n,...l}=te[e.type];return l},rn=e=>{if(!ze(e.type))return;let{component:n,...l}=te[e.type];return n},le,b,Xe,an,I,me,Ye,Ie,Fe,ce,oe,ue,on,W={},De=[],un=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,re=Array.isArray;function M(e,n){for(var l in n)e[l]=n[l];return e}function pe(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function sn(e,n,l){var t,a,r,u={};for(r in n)r=="key"?t=n[r]:r=="ref"?a=n[r]:u[r]=n[r];if(arguments.length>2&&(u.children=arguments.length>3?le.call(arguments,2):l),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)u[r]===void 0&&(u[r]=e.defaultProps[r]);return G(e,u,t,a,null)}function G(e,n,l,t,a){var r={type:e,props:n,key:l,ref:t,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++Xe,__i:-1,__u:0};return a==null&&b.vnode!=null&&b.vnode(r),r}function F(e){return e.children}function K(e,n){this.props=e,this.context=n}function U(e,n){if(n==null)return e.__?U(e.__,e.__i+1):null;for(var l;n<e.__k.length;n++)if((l=e.__k[n])!=null&&l.__e!=null)return l.__e;return typeof e.type=="function"?U(e):null}function Ue(e){var n,l;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,n=0;n<e.__k.length;n++)if((l=e.__k[n])!=null&&l.__e!=null){e.__e=e.__c.base=l.__e;break}return Ue(e)}}function ge(e){(!e.__d&&(e.__d=!0)&&I.push(e)&&!Z.__r++||me!=b.debounceRendering)&&((me=b.debounceRendering)||Ye)(Z)}function Z(){for(var e,n,l,t,a,r,u,o=1;I.length;)I.length>o&&I.sort(Ie),e=I.shift(),o=I.length,e.__d&&(l=void 0,a=(t=(n=e).__v).__e,r=[],u=[],n.__P&&((l=M({},t)).__v=t.__v+1,b.vnode&&b.vnode(l),_e(n.__P,l,t,n.__n,n.__P.namespaceURI,32&t.__u?[a]:null,r,a??U(t),!!(32&t.__u),u),l.__v=t.__v,l.__.__k[l.__i]=l,Be(r,l,u),l.__e!=a&&Ue(l)));Z.__r=0}function Re(e,n,l,t,a,r,u,o,c,s,p){var i,_,d,k,v,g,f=t&&t.__k||De,m=n.length;for(c=cn(l,n,f,c,m),i=0;i<m;i++)(d=l.__k[i])!=null&&(_=d.__i==-1?W:f[d.__i]||W,d.__i=i,g=_e(e,d,_,a,r,u,o,c,s,p),k=d.__e,d.ref&&_.ref!=d.ref&&(_.ref&&de(_.ref,null,d),p.push(d.ref,d.__c||k,d)),v==null&&k!=null&&(v=k),4&d.__u||_.__k===d.__k?c=$e(d,c,e):typeof d.type=="function"&&g!==void 0?c=g:k&&(c=k.nextSibling),d.__u&=-7);return l.__e=v,c}function cn(e,n,l,t,a){var r,u,o,c,s,p=l.length,i=p,_=0;for(e.__k=new Array(a),r=0;r<a;r++)(u=n[r])!=null&&typeof u!="boolean"&&typeof u!="function"?(c=r+_,(u=e.__k[r]=typeof u=="string"||typeof u=="number"||typeof u=="bigint"||u.constructor==String?G(null,u,null,null,null):re(u)?G(F,{children:u},null,null,null):u.constructor==null&&u.__b>0?G(u.type,u.props,u.key,u.ref?u.ref:null,u.__v):u).__=e,u.__b=e.__b+1,o=null,(s=u.__i=pn(u,l,c,i))!=-1&&(i--,(o=l[s])&&(o.__u|=2)),o==null||o.__v==null?(s==-1&&(a>p?_--:a<p&&_++),typeof u.type!="function"&&(u.__u|=4)):s!=c&&(s==c-1?_--:s==c+1?_++:(s>c?_--:_++,u.__u|=4))):e.__k[r]=null;if(i)for(r=0;r<p;r++)(o=l[r])!=null&&(2&o.__u)==0&&(o.__e==t&&(t=U(o)),Ve(o,o));return t}function $e(e,n,l){var t,a;if(typeof e.type=="function"){for(t=e.__k,a=0;t&&a<t.length;a++)t[a]&&(t[a].__=e,n=$e(t[a],n,l));return n}e.__e!=n&&(n&&e.type&&!l.contains(n)&&(n=U(e)),l.insertBefore(e.__e,n||null),n=e.__e);do n=n&&n.nextSibling;while(n!=null&&n.nodeType==8);return n}function pn(e,n,l,t){var a,r,u=e.key,o=e.type,c=n[l];if(c===null&&e.key==null||c&&u==c.key&&o==c.type&&(2&c.__u)==0)return l;if(t>(c!=null&&(2&c.__u)==0?1:0))for(a=l-1,r=l+1;a>=0||r<n.length;){if(a>=0){if((c=n[a])&&(2&c.__u)==0&&u==c.key&&o==c.type)return a;a--}if(r<n.length){if((c=n[r])&&(2&c.__u)==0&&u==c.key&&o==c.type)return r;r++}}return-1}function ke(e,n,l){n[0]=="-"?e.setProperty(n,l??""):e[n]=l==null?"":typeof l!="number"||un.test(n)?l:l+"px"}function J(e,n,l,t,a){var r,u;e:if(n=="style")if(typeof l=="string")e.style.cssText=l;else{if(typeof t=="string"&&(e.style.cssText=t=""),t)for(n in t)l&&n in l||ke(e.style,n,"");if(l)for(n in l)t&&l[n]==t[n]||ke(e.style,n,l[n])}else if(n[0]=="o"&&n[1]=="n")r=n!=(n=n.replace(Fe,"$1")),u=n.toLowerCase(),n=u in e||n=="onFocusOut"||n=="onFocusIn"?u.slice(2):n.slice(2),e.l||(e.l={}),e.l[n+r]=l,l?t?l.u=t.u:(l.u=ce,e.addEventListener(n,r?ue:oe,r)):e.removeEventListener(n,r?ue:oe,r);else{if(a=="http://www.w3.org/2000/svg")n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(n!="width"&&n!="height"&&n!="href"&&n!="list"&&n!="form"&&n!="tabIndex"&&n!="download"&&n!="rowSpan"&&n!="colSpan"&&n!="role"&&n!="popover"&&n in e)try{e[n]=l??"";break e}catch{}typeof l=="function"||(l==null||l===!1&&n[4]!="-"?e.removeAttribute(n):e.setAttribute(n,n=="popover"&&l==1?"":l))}}function be(e){return function(n){if(this.l){var l=this.l[n.type+e];if(n.t==null)n.t=ce++;else if(n.t<l.u)return;return l(b.event?b.event(n):n)}}}function _e(e,n,l,t,a,r,u,o,c,s){var p,i,_,d,k,v,g,f,m,w,N,S,P,z,X,A,V,E=n.type;if(n.constructor!=null)return null;128&l.__u&&(c=!!(32&l.__u),r=[o=n.__e=l.__e]),(p=b.__b)&&p(n);e:if(typeof E=="function")try{if(f=n.props,m="prototype"in E&&E.prototype.render,w=(p=E.contextType)&&t[p.__c],N=p?w?w.props.value:p.__:t,l.__c?g=(i=n.__c=l.__c).__=i.__E:(m?n.__c=i=new E(f,N):(n.__c=i=new K(f,N),i.constructor=E,i.render=dn),w&&w.sub(i),i.props=f,i.state||(i.state={}),i.context=N,i.__n=t,_=i.__d=!0,i.__h=[],i._sb=[]),m&&i.__s==null&&(i.__s=i.state),m&&E.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=M({},i.__s)),M(i.__s,E.getDerivedStateFromProps(f,i.__s))),d=i.props,k=i.state,i.__v=n,_)m&&E.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),m&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(m&&E.getDerivedStateFromProps==null&&f!==d&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(f,N),!i.__e&&i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(f,i.__s,N)===!1||n.__v==l.__v){for(n.__v!=l.__v&&(i.props=f,i.state=i.__s,i.__d=!1),n.__e=l.__e,n.__k=l.__k,n.__k.some(function(Y){Y&&(Y.__=n)}),S=0;S<i._sb.length;S++)i.__h.push(i._sb[S]);i._sb=[],i.__h.length&&u.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(f,i.__s,N),m&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(d,k,v)})}if(i.context=N,i.props=f,i.__P=e,i.__e=!1,P=b.__r,z=0,m){for(i.state=i.__s,i.__d=!1,P&&P(n),p=i.render(i.props,i.state,i.context),X=0;X<i._sb.length;X++)i.__h.push(i._sb[X]);i._sb=[]}else do i.__d=!1,P&&P(n),p=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++z<25);i.state=i.__s,i.getChildContext!=null&&(t=M(M({},t),i.getChildContext())),m&&!_&&i.getSnapshotBeforeUpdate!=null&&(v=i.getSnapshotBeforeUpdate(d,k)),A=p,p!=null&&p.type===F&&p.key==null&&(A=je(p.props.children)),o=Re(e,re(A)?A:[A],n,l,t,a,r,u,o,c,s),i.base=n.__e,n.__u&=-161,i.__h.length&&u.push(i),g&&(i.__E=i.__=null)}catch(Y){if(n.__v=null,c||r!=null)if(Y.then){for(n.__u|=c?160:128;o&&o.nodeType==8&&o.nextSibling;)o=o.nextSibling;r[r.indexOf(o)]=null,n.__e=o}else for(V=r.length;V--;)pe(r[V]);else n.__e=l.__e,n.__k=l.__k;b.__e(Y,n,l)}else r==null&&n.__v==l.__v?(n.__k=l.__k,n.__e=l.__e):o=n.__e=_n(l.__e,n,l,t,a,r,u,c,s);return(p=b.diffed)&&p(n),128&n.__u?void 0:o}function Be(e,n,l){for(var t=0;t<l.length;t++)de(l[t],l[++t],l[++t]);b.__c&&b.__c(n,e),e.some(function(a){try{e=a.__h,a.__h=[],e.some(function(r){r.call(a)})}catch(r){b.__e(r,a.__v)}})}function je(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:re(e)?e.map(je):M({},e)}function _n(e,n,l,t,a,r,u,o,c){var s,p,i,_,d,k,v,g=l.props,f=n.props,m=n.type;if(m=="svg"?a="http://www.w3.org/2000/svg":m=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),r!=null){for(s=0;s<r.length;s++)if((d=r[s])&&"setAttribute"in d==!!m&&(m?d.localName==m:d.nodeType==3)){e=d,r[s]=null;break}}if(e==null){if(m==null)return document.createTextNode(f);e=document.createElementNS(a,m,f.is&&f),o&&(b.__m&&b.__m(n,r),o=!1),r=null}if(m==null)g===f||o&&e.data==f||(e.data=f);else{if(r=r&&le.call(e.childNodes),g=l.props||W,!o&&r!=null)for(g={},s=0;s<e.attributes.length;s++)g[(d=e.attributes[s]).name]=d.value;for(s in g)if(d=g[s],s!="children"){if(s=="dangerouslySetInnerHTML")i=d;else if(!(s in f)){if(s=="value"&&"defaultValue"in f||s=="checked"&&"defaultChecked"in f)continue;J(e,s,null,d,a)}}for(s in f)d=f[s],s=="children"?_=d:s=="dangerouslySetInnerHTML"?p=d:s=="value"?k=d:s=="checked"?v=d:o&&typeof d!="function"||g[s]===d||J(e,s,d,g[s],a);if(p)o||i&&(p.__html==i.__html||p.__html==e.innerHTML)||(e.innerHTML=p.__html),n.__k=[];else if(i&&(e.innerHTML=""),Re(n.type=="template"?e.content:e,re(_)?_:[_],n,l,t,m=="foreignObject"?"http://www.w3.org/1999/xhtml":a,r,u,r?r[0]:l.__k&&U(l,0),o,c),r!=null)for(s=r.length;s--;)pe(r[s]);o||(s="value",m=="progress"&&k==null?e.removeAttribute("value"):k!=null&&(k!==e[s]||m=="progress"&&!k||m=="option"&&k!=g[s])&&J(e,s,k,g[s],a),s="checked",v!=null&&v!=e[s]&&J(e,s,v,g[s],a))}return e}function de(e,n,l){try{if(typeof e=="function"){var t=typeof e.__u=="function";t&&e.__u(),t&&n==null||(e.__u=e(n))}else e.current=n}catch(a){b.__e(a,l)}}function Ve(e,n,l){var t,a;if(b.unmount&&b.unmount(e),(t=e.ref)&&(t.current&&t.current!=e.__e||de(t,null,n)),(t=e.__c)!=null){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(r){b.__e(r,n)}t.base=t.__P=null}if(t=e.__k)for(a=0;a<t.length;a++)t[a]&&Ve(t[a],n,l||typeof e.type!="function");l||pe(e.__e),e.__c=e.__=e.__e=void 0}function dn(e,n,l){return this.constructor(e,l)}function ye(e,n,l){var t,a,r,u;n==document&&(n=document.documentElement),b.__&&b.__(e,n),a=(t=typeof l=="function")?null:l&&l.__k||n.__k,r=[],u=[],_e(n,e=(!t&&l||n).__k=sn(F,null,[e]),a||W,W,n.namespaceURI,!t&&l?[l]:a?null:n.firstChild?le.call(n.childNodes):null,r,!t&&l?l:a?a.__e:n.firstChild,t,u),Be(r,e,u)}le=De.slice,b={__e:function(e,n,l,t){for(var a,r,u;n=n.__;)if((a=n.__c)&&!a.__)try{if((r=a.constructor)&&r.getDerivedStateFromError!=null&&(a.setState(r.getDerivedStateFromError(e)),u=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(e,t||{}),u=a.__d),u)return a.__E=a}catch(o){e=o}throw e}},Xe=0,an=function(e){return e!=null&&e.constructor==null},K.prototype.setState=function(e,n){var l;l=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=M({},this.state),typeof e=="function"&&(e=e(M({},l),this.props)),e&&M(l,e),e!=null&&this.__v&&(n&&this._sb.push(n),ge(this))},K.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ge(this))},K.prototype.render=F,I=[],Ye=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ie=function(e,n){return e.__v.__b-n.__v.__b},Z.__r=0,Fe=/(PointerCapture)$|Capture$/i,ce=0,oe=be(!1),ue=be(!0),on=0;var hn=0,Bn=Array.isArray;function h(e,n,l,t,a,r){n||(n={});var u,o,c=n;if("ref"in c)for(o in c={},n)o=="ref"?u=n[o]:c[o]=n[o];var s={type:e,props:c,key:l,ref:u,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--hn,__i:-1,__u:0,__source:a,__self:r};if(typeof e=="function"&&(u=e.defaultProps))for(o in u)c[o]===void 0&&(c[o]=u[o]);return b.vnode&&b.vnode(s),s}var fn=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id];return h("button",{type:"button",onClick:()=>l({[t.id]:{value:!0}},{event:!0}),children:t.text??t.id})};C("button",fn,{label:null});var q,y,ie,xe,ee=0,We=[],x=b,we=x.__b,Ne=x.__r,Se=x.diffed,Ee=x.__c,Ce=x.unmount,Te=x.__;function he(e,n){x.__h&&x.__h(y,e,ee||n),ee=0;var l=y.__H||(y.__H={__:[],__h:[]});return e>=l.__.length&&l.__.push({}),l.__[e]}function L(e){return ee=1,vn(Oe,e)}function vn(e,n,l){var t=he(q++,2);if(t.t=e,!t.__c&&(t.__=[l?l(n):Oe(void 0,n),function(o){var c=t.__N?t.__N[0]:t.__[0],s=t.t(c,o);c!==s&&(t.__N=[s,t.__[1]],t.__c.setState({}))}],t.__c=y,!y.__f)){var a=function(o,c,s){if(!t.__c.__H)return!0;var p=t.__c.__H.__.filter(function(_){return!!_.__c});if(p.every(function(_){return!_.__N}))return!r||r.call(this,o,c,s);var i=t.__c.props!==o;return p.forEach(function(_){if(_.__N){var d=_.__[0];_.__=_.__N,_.__N=void 0,d!==_.__[0]&&(i=!0)}}),r&&r.call(this,o,c,s)||i};y.__f=!0;var r=y.shouldComponentUpdate,u=y.componentWillUpdate;y.componentWillUpdate=function(o,c,s){if(this.__e){var p=r;r=void 0,a(o,c,s),r=p}u&&u.call(this,o,c,s)},y.shouldComponentUpdate=a}return t.__N||t.__}function R(e,n){var l=he(q++,3);!x.__s&&qe(l.__H,n)&&(l.__=e,l.u=n,y.__H.__h.push(l))}function mn(e){return ee=5,gn(function(){return{current:e}},[])}function gn(e,n){var l=he(q++,7);return qe(l.__H,n)&&(l.__=e(),l.__H=n,l.__h=e),l.__}function kn(){for(var e;e=We.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Q),e.__H.__h.forEach(se),e.__H.__h=[]}catch(n){e.__H.__h=[],x.__e(n,e.__v)}}x.__b=function(e){y=null,we&&we(e)},x.__=function(e,n){e&&n.__k&&n.__k.__m&&(e.__m=n.__k.__m),Te&&Te(e,n)},x.__r=function(e){Ne&&Ne(e),q=0;var n=(y=e.__c).__H;n&&(ie===y?(n.__h=[],y.__h=[],n.__.forEach(function(l){l.__N&&(l.__=l.__N),l.u=l.__N=void 0})):(n.__h.forEach(Q),n.__h.forEach(se),n.__h=[],q=0)),ie=y},x.diffed=function(e){Se&&Se(e);var n=e.__c;n&&n.__H&&(n.__H.__h.length&&(We.push(n)!==1&&xe===x.requestAnimationFrame||((xe=x.requestAnimationFrame)||bn)(kn)),n.__H.__.forEach(function(l){l.u&&(l.__H=l.u),l.u=void 0})),ie=y=null},x.__c=function(e,n){n.some(function(l){try{l.__h.forEach(Q),l.__h=l.__h.filter(function(t){return!t.__||se(t)})}catch(t){n.some(function(a){a.__h&&(a.__h=[])}),n=[],x.__e(t,l.__v)}}),Ee&&Ee(e,n)},x.unmount=function(e){Ce&&Ce(e);var n,l=e.__c;l&&l.__H&&(l.__H.__.forEach(function(t){try{Q(t)}catch(a){n=a}}),l.__H=void 0,n&&x.__e(n,l.__v))};var Pe=typeof requestAnimationFrame=="function";function bn(e){var n,l=function(){clearTimeout(t),Pe&&cancelAnimationFrame(n),setTimeout(e)},t=setTimeout(l,35);Pe&&(n=requestAnimationFrame(l))}function Q(e){var n=y,l=e.__c;typeof l=="function"&&(e.__c=void 0,l()),y=n}function se(e){var n=y;e.__c=e.__(),y=n}function qe(e,n){return!e||e.length!==n.length||n.some(function(l,t){return l!==e[t]})}function Oe(e,n){return typeof n=="function"?n(e):n}var Ae=e=>e.trim()==="",Me=e=>isFinite(e),yn=(e,n)=>String(e)!==n,xn=(e,n,l)=>e>=n&&e<=l,wn=(e,n,l)=>Math.min(Math.max(e,n),l),ne=({value:e,min:n=-1/0,max:l=1/0,commit:t})=>{let[a,r]=L(String(e)),[u,o]=L(e);R(()=>{r(String(e)),o(e)},[e]);function c(p){let i=String(p);if(r(i),Ae(i))return;let _=Number(i);!Me(_)||!xn(_,n,l)||yn(_,i)||(o(_),t(_))}function s(){if(Ae(a)||!Me(Number(a))){r(String(u));return}let p=Number(a),i=wn(p,n,l);r(String(i)),o(i),t(i)}return{value:e,text:a,setValue:c,handleBlur:s}},ae=e=>Array.isArray(e)&&e.every(n=>n!=null&&typeof n=="object"&&!Array.isArray(n)&&"label"in n&&"value"in n)?e:Array.isArray(e)?e.map(n=>({label:String(n),value:n})):e&&typeof e=="object"?Object.entries(e).map(([n,l])=>({label:n,value:l})):[],Nn=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id],a=ae(t.options).map(({label:r,value:u},o)=>{let c=t.value===u?"knurl-selected":"";return h("button",{onClick:()=>l({[t.id]:{value:u}}),className:`${c}`,type:"button",children:r},r)});return h("div",{className:"knurl-buttons",children:a})};C("buttons",Nn,{value:e=>ae(e.options)[0]?.value});var Sn=e=>"#ffffff",En=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id],[a,r]=L(t.value),[u,o]=L(t.value);R(()=>{r(t.value)},[t.value]);let c=i=>i.startsWith("#")&&i.length===7&&CSS.supports("color",i),s=i=>{let _=i.currentTarget.value,d=c(_)?_:u;l({[t.id]:{value:d}}),r(d)},p=i=>{let _=i.currentTarget.value;c(_)&&(l({[t.id]:{value:_}}),o(_))};return h(F,{children:[h("input",{type:"color",value:a,onInput:p,className:"knurl-color-picker"}),h("input",{type:"text",className:"knurl-fixed",size:"7",value:a,onInput:p,onChange:s})]})};C("color",En,{value:Sn});var Cn=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id];switch(t.format){case"monospace":return h("span",{className:"knurl-display knurl-monospace",children:t.value});case"block":return h("pre",{className:"knurl-display knurl-monospace",children:t.value});case"html":return h("span",{className:"knurl-display",dangerouslySetInnerHTML:{__html:t.value??""}});default:return h("span",{className:"knurl-display",children:t.value})}};C("display",Cn,{value:"",format:"text"});var Tn=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id],a=mn(null),[r,u]=L(Array(t.samples).fill(0)),[o,c]=L({min:null,max:null});return R(()=>{u(s=>[...s,t.value].slice(-t.samples)),c(s=>({min:s.min===null?t.value:Math.min(s.min,t.value),max:s.max===null?t.value:Math.max(s.max,t.value)}))},[t]),R(()=>{let s=a.current;if(!s)return;let p=s.getContext("2d"),i=s.getBoundingClientRect(),_=window.devicePixelRatio||1,d=i.width,k=t.height;s.width=d*_,s.height=k*_,p.scale(_,_),s.style.width=d+"px",s.style.height=k+"px",p.clearRect(0,0,d,k);let v=s.closest(".knurl"),g=getComputedStyle(v).getPropertyValue("--panel-fg").trim()||"#aaa",f=t.min??o.min??0,m=t.max??o.max??1,w=m-f||1,N=1/(t.samples-1)*d;p.fillStyle=g,p.globalAlpha=.5,p.beginPath(),p.moveTo(0,k),r.forEach((S,P)=>{let z=(S-f)/w*k,X=P*N,A=k-z;p.lineTo(X,A)}),p.lineTo(d,k),p.fill(),p.globalAlpha=1,p.font="10px ui-monospace, monospace",p.textBaseline="top",p.textAlign="left",p.fillText(m,3,0),p.textBaseline="bottom",p.fillText(f,3,k)},[r,o,t]),h("canvas",{className:"knurl-graph",ref:a,height:t.height})};C("graph",Tn,{height:60,samples:60});var Je=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id];if(!t.visible)return null;let a=rn(t);if(!a)return null;let r=h(a,{nodes:e,treeNode:n,update:l});if(t.layout==="block")return r;let u=!(t.label===""||t.label===null);return h("div",{className:"knurl-row",role:"group","aria-label":t.label??t.id,children:[u&&h("span",{className:"knurl-label",children:t.label??t.id}),h("div",{className:"knurl-control",children:r})]})},Pn=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id],a=n.nodes.map((c,s)=>h(Je,{nodes:e,treeNode:c,update:l},c.id)),r=t.expanded?"knurl-expanded":"knurl-collapsed",u=t.showLabel?"knurl-show-label":"knurl-hide-label",o=!(t.label===""||t.label===null);return h("div",{className:`knurl-group ${r} ${u}`,children:[o&&h("span",{className:"knurl-label",onClick:()=>{t.expandable&&l({[t.id]:{expanded:!t.expanded}})},children:[t.expandable&&h("span",{className:"knurl-icon",children:"\u2303"}),t.label??t.id]}),h("div",{className:"knurl-group-container",children:a})]})};C("group",Pn,{layout:"block",expandable:!0,expanded:!0});var An=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id],{text:a,setValue:r,handleBlur:u}=ne({value:t.value,min:t.min,max:t.max,commit:o=>l({[t.id]:{value:o}})});return h("input",{className:"knurl-number-input",type:"text",value:a,onInput:o=>r(o.currentTarget.value),onChange:u})};C("number",An,{value:()=>0});var Le=(e,n)=>{let l=1/n;return Math.round(e*l)/l},Mn=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id],{x:a,y:r}=t.value,[u,o]=L(!1),[c,s]=L(null),[p,i]=L({height:176,width:176,space:6,radius:2});R(()=>{let v=document.querySelector(".knurl");if(!v)return;let g=getComputedStyle(v),f=g.getPropertyValue("--panel-width"),m=g.getPropertyValue("--label-width"),w=g.getPropertyValue("--panel-radius"),N=g.getPropertyValue("--panel-space"),S=parseFloat(f)-parseFloat(m)-2*parseFloat(N),P=parseFloat(w),z=parseFloat(N);i({width:S,height:S,radius:P,space:z})},[]);let _=ne({value:t.value.x,min:t.minX,max:t.maxX,commit:v=>l({[t.id]:{value:{...t.value,x:v}}})}),d=ne({value:t.value.y,min:t.minY,max:t.maxY,commit:v=>l({[t.id]:{value:{...t.value,y:v}}})});R(()=>{if(!u||!c)return;let v=document.body.style.cursor;document.body.style.cursor="grabbing";let g=w=>{let N=w.clientX??w.touches?.[0]?.clientX,S=w.clientY??w.touches?.[0]?.clientY;if(N===void 0||S===void 0)return;let P=N-c.pointerX,z=S-c.pointerY,X=c.valueX+P*t.scale,A=c.valueY+z*t.scale,V=Math.max(t.minX,Math.min(t.maxX,X)),E=Math.max(t.minY,Math.min(t.maxY,A)),Y=Le(V,t.step),nn=Le(E,t.step);l({[t.id]:{value:{x:Y,y:nn}}})},f=()=>{o(!1),s(null)},m=w=>(w.preventDefault(),!1);return document.addEventListener("mousemove",g),document.addEventListener("mouseup",f),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",f),()=>{document.body.style.cursor=v,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",f)}},[u,c,t]);let k=(v,g=null)=>{let f=v.clientX??v.touches?.[0]?.clientX,m=v.clientY??v.touches?.[0]?.clientY;o(!0),s({pointerX:f,pointerY:m,valueX:g?.x??t.value.x,valueY:g?.y??t.value.y})};return h(F,{children:[h("button",{onMouseDown:v=>{v.preventDefault(),k(v)},onTouchStart:v=>{v.preventDefault(),k(v)},className:`knurl-translate ${u?"knurl-selected":""}`,type:"button",style:{touchAction:"none",userSelect:"none"},children:"\u2316"}),h("input",{className:"knurl-number-input knurl-fixed",type:"text",size:"7",value:_.text,onInput:v=>_.setValue(v.currentTarget.value),onChange:_.handleBlur}),h("input",{className:"knurl-number-input knurl-fixed",type:"text",size:"7",value:d.text,onInput:v=>d.setValue(v.currentTarget.value),onChange:d.handleBlur}),u&&h("div",{className:"knurl-pad2",children:h("svg",{width:p.width,height:p.height,style:{position:"absolute",top:0,left:0,borderRadius:p.radius},children:[h("rect",{width:p.width,height:p.height,fill:"transparent",className:"knurl-border",rx:p.radius}),h("line",{x1:p.width/2,y1:0,x2:p.width/2,y2:p.height,className:"knurl-grid"}),h("line",{x1:0,y1:p.height/2,x2:p.width,y2:p.height/2,className:"knurl-grid"}),h("text",{x:p.space,y:p.space,className:"knurl-label","dominant-baseline":"hanging","font-size":"10",children:[t.minX,",",t.minY]}),h("text",{x:p.width-p.space,y:p.space,"dominant-baseline":"hanging",className:"knurl-label","font-size":"10","text-anchor":"end",children:[t.maxX,",",t.minY]}),h("text",{x:p.space,y:p.height-p.space,className:"knurl-label","font-size":"10",children:[t.minX,",",t.maxY]}),h("text",{x:p.width-p.space,y:p.height-p.space,className:"knurl-label","font-size":"10","text-anchor":"end",children:[t.maxX,",",t.maxY]}),h("circle",{cx:(a-t.minX)/(t.maxX-t.minX)*p.width,cy:(r-t.minY)/(t.maxY-t.minY)*p.height,r:6,className:"knurl-indicator"})]})})]})};C("pad2",Mn,{value:e=>({x:e.minX+(e.maxX-e.minX)*.5,y:e.minY+(e.maxY-e.minY)*.5}),scale:.01,step:.01,minX:-1,maxX:1,minY:-1,maxY:1});var Ln=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id],{text:a,setValue:r,handleBlur:u}=ne({value:t.value,min:t.min,max:t.max,commit:o=>l({[t.id]:{value:o}})});return h(F,{children:[h("input",{type:"range",value:a,min:t.min,max:t.max,step:t.step??1,onInput:o=>r(o.currentTarget.value)}),h("input",{type:"text",size:"7",className:"knurl-number-input knurl-fixed",value:a,onInput:o=>r(o.currentTarget.value),onChange:u})]})};C("range",Ln,{value:e=>e.min??0});var Hn=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id],a=ae(t.options),r=c=>{let s=Number(c.currentTarget.value),p=a[s].value;l({[t.id]:{value:p}})},u=a.map(({label:c},s)=>h("option",{value:s,children:c},c)),o=a.findIndex(({value:c})=>c===t.value);return h("select",{value:o<0?"":o,onChange:r,children:u})};C("select",Hn,{value:e=>ae(e.options)[0]?.value});var zn=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id],a=r=>{l({[t.id]:{value:r.currentTarget.value}})};return t.multiline?h("textarea",{value:t.value,onInput:a,rows:t.rows}):h("input",{type:"text",value:t.value,onInput:a})};C("text",zn,{value:"",multiline:!1,rows:4});var Xn=({nodes:e,treeNode:n,update:l})=>{let t=e[n.id];return h("input",{type:"checkbox",checked:t.value,onInput:a=>l({[t.id]:{value:a.currentTarget.checked}})})};C("toggle",Xn,{value:e=>!1});var Yn='.knurl-container{position:fixed;top:0;right:0}.knurl{--panel-bg: hsl(230 7% 10%);--panel-fg: hsl(230 10% 75%);--panel-border: hsl(230 9% 18%);--panel-hover: hsl(230 9% 26%);--panel-pressed: hsl(230 7% 16%);--panel-low-emphasis: hsl(230 4% 55%);--panel-focus: var(--panel-fg);--panel-selection-fg: var(--panel-bg);--panel-selection-bg: var(--panel-fg);--value-number: hsl(220 80% 65%);--value-string: hsl(139 45% 56%);--panel-space: 4px;--panel-radius: 2px;--panel-width: 256px;--label-width: 80px;--row-height: 20px;--font-ui: system-ui, -apple-system, sans-serif;--font-value: ui-monospace, monospace;--font-size-normal: 11px;--line-height-normal: 1.4;--color-link: var(--value-number);--panel-tween-func: cubic-bezier(.25, .8, .5, 1);--panel-tween-duration: .2s;--checkbox-check-width: 3px;--checkbox-check-height: 9px;width:var(--panel-width);color:var(--panel-fg);font-family:var(--font-ui);font-size:var(--font-size-normal);line-height:var(--line-height-normal);box-sizing:border-box;font-variant-numeric:tabular-nums}.knurl .knurl-row{display:flex;flex-direction:row;gap:var(--panel-space);padding:var(--panel-space) var(--panel-space)}.knurl .knurl-row+.knurl-row{padding-top:calc(var(--panel-space) * .5)}.knurl .knurl-row:has(+.knurl-row){padding-bottom:calc(var(--panel-space) * .5)}.knurl .knurl-group-container .knurl-group-container{border-bottom:1px solid var(--panel-border)}.knurl .knurl-row .knurl-label{display:flex;align-self:flex-start;align-items:center;line-height:1.2;min-height:20px;min-width:0;user-select:none;color:var(--panel-low-emphasis);flex:0 0 var(--label-width)}.knurl .knurl-group{display:flex;flex-direction:column;background:var(--panel-bg);border-radius:var(--panel-radius)}.knurl-container>.knurl>.knurl-group>.knurl-label{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.knurl .knurl-group>.knurl-label{display:flex;align-items:center;user-select:none;background:var(--panel-border);border-radius:var(--panel-radius);height:var(--row-height);padding-left:var(--panel-space);gap:var(--panel-space)}.knurl .knurl-group>.knurl-label:has(>.knurl-icon){cursor:pointer}.knurl .knurl-group>.knurl-label>.knurl-icon{font-weight:700;font-size:10px;cursor:pointer}@media (prefers-reduced-motion: no-preference){.knurl .knurl-group>.knurl-label>.knurl-icon{transition:transform var(--panel-tween-duration) var(--panel-tween-func)}}.knurl .knurl-group.knurl-expanded>.knurl-label>.knurl-icon{transform:rotate(180deg)}.knurl .knurl-group>.knurl-group-container{flex-direction:column;overflow:hidden;display:none}.knurl .knurl-group.knurl-expanded>.knurl-group-container{display:flex}@supports (interpolate-size: allow-keywords){.knurl .knurl-group>.knurl-group-container{display:flex;interpolate-size:allow-keywords;height:0;opacity:0}@media (prefers-reduced-motion: no-preference){.knurl .knurl-group>.knurl-group-container{transition:height var(--panel-tween-duration) var(--panel-tween-func),padding var(--panel-tween-duration) var(--panel-tween-func),opacity var(--panel-tween-duration) var(--panel-tween-func)}}.knurl .knurl-group.knurl-expanded>.knurl-group-container{height:auto;opacity:1}}.knurl-container>.knurl{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.knurl .knurl-row .knurl-control{flex:1 1 auto;display:flex;justify-content:flex-start;align-items:center;min-height:var(--row-height);gap:var(--panel-space)}.knurl button,.knurl input,.knurl select,.knurl textarea{font-size:inherit;font-family:inherit;width:100%;box-sizing:border-box;border:1px solid transparent;padding:0 var(--panel-space);border-radius:var(--panel-radius);background:var(--panel-border);color:var(--panel-fg)}.knurl button,.knurl select,.knurl input[type=text],.knurl input[type=range]{min-height:var(--row-height)}.knurl input[type=color]{height:var(--row-height)}.knurl button,.knurl select,.knurl input[type=checkbox],.knurl input[type=range],.knurl input[type=color]{cursor:pointer}.knurl input[type=text],.knurl textarea{cursor:text}.knurl button:focus-visible,.knurl select:focus-visible,.knurl input:focus-visible,.knurl textarea:focus-visible{outline:2px solid var(--panel-focus);outline-offset:0px}.knurl button:focus:not(:focus-visible),.knurl select:focus:not(:focus-visible),.knurl input:focus:not(:focus-visible),.knurl textarea:focus:not(:focus-visible){outline:none}.knurl button:hover:not(:active):not(.knurl-selected),.knurl input:hover,.knurl select:hover,.knurl textarea:hover{background:var(--panel-hover)}.knurl button:active,.knurl button.knurl-selected{background:var(--panel-fg);color:var(--panel-bg);border-radius:var(--panel-radius)}.knurl input::selection,.knurl textarea::selection{background:var(--panel-selection-bg);color:var(--panel-selection-fg)}.knurl textarea{resize:vertical;min-height:calc(var(--row-height) * 2 + var(--panel-space));line-height:var(--line-height-normal);color:var(--value-string);font-family:var(--font-value)}.knurl .knurl-buttons{display:flex;flex-direction:row;flex:1;gap:var(--panel-space)}.knurl .knurl-pad2{position:absolute;align-self:flex-start;margin-top:calc(var(--row-height) + var(--panel-space));width:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));height:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));background:var(--panel-bg);z-index:1001}.knurl .knurl-pad2 .knurl-border,.knurl .knurl-pad2 .knurl-grid{stroke:var(--panel-fg);stroke-opacity:.25}.knurl .knurl-pad2 .knurl-label{fill:var(--panel-fg);opacity:.5}.knurl .knurl-pad2 .knurl-indicator{fill:var(--panel-fg)}.knurl button.knurl-translate{font-weight:bolder}.knurl button.knurl-translate.knurl-selected{cursor:grabbing}.knurl input[type=text]{color:var(--value-string);font-family:var(--font-value)}.knurl input[type=text].knurl-number-input{color:var(--value-number)}.knurl input[type=number]::-webkit-inner-spin-button,.knurl input[type=number]::-webkit-outer-spin-button{appearance:none;margin:0}.knurl input[type=text].knurl-fixed{width:60px}.knurl .knurl-control>.knurl-display{line-height:var(--row-height)}.knurl .knurl-control>.knurl-display.knurl-monospace{font-family:var(--font-value)}.knurl .knurl-display a{color:var(--color-link);text-decoration:underline}.knurl .knurl-display a:hover{text-decoration:none}.knurl pre.knurl-display{margin:0}.knurl input[type=checkbox]{margin:0;appearance:none;border-radius:var(--panel-radius);width:14px;height:14px;text-align:center}.knurl input[type=checkbox]:checked:before{content:"";display:flex;height:var(--checkbox-check-height);width:var(--checkbox-check-width);border-bottom:2px solid var(--panel-fg);border-right:2px solid var(--panel-fg);transform:rotate(45deg)}.knurl input[type=range]{-webkit-appearance:none;appearance:none;background:transparent;margin:0;padding:0}.knurl input[type=range]::-webkit-slider-runnable-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.knurl input[type=range]::-moz-range-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.knurl input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);margin-top:-4px}.knurl input[type=range]::-moz-range-thumb{width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);border:none}.knurl input[type=color]{-webkit-appearance:none;border:1px solid var(--panel-border);padding:0;border-radius:var(--panel-radius);height:var(--row-height)}.knurl input[type=color]::-webkit-color-swatch-wrapper{padding:0}.knurl input[type=color]::-webkit-color-swatch{border:0}.knurl canvas.knurl-graph{width:100%}',In=0,Fn=e=>`node ${In++}`,Ge=e=>{let{id:n=Fn(),nodes:l=[],...t}=e,a={},r={id:n,nodes:[]},u={id:n},o=ln(e);for(let c in o)typeof o[c]=="function"?u[c]=o[c]({...o,...e}):u[c]=o[c];return Object.assign(u,t),a[n]=u,l.length>0&&l.forEach(c=>{let[s,p]=Ge(c);Object.assign(a,s),r.nodes.push(p)}),[a,r]},Dn=()=>{let e=document.createElement("div");return e.classList.add("knurl-container"),document.body.append(e),e},Un=()=>{if(!document.querySelector("style[data-knurl]")){let e=document.createElement("style");e.textContent=Yn,e.setAttribute("data-knurl","true"),document.head.appendChild(e)}},He=Symbol("all"),Rn=class{constructor(e,n){let[l,t]=Ge(e);this.nodes=l,this.root=t,this.container=n.mount??Dn(),this.options=n,this.subscribers=new Map,this.raf=null,n.injectStyles&&Un(),this.render()}render(){let e=()=>{ye(h("div",{className:`knurl ${this.options.classNames.join(" ")}`,children:h(Je,{nodes:this.nodes,treeNode:this.root,update:this.handleUpdate.bind(this)})}),this.container)};if(!this.options.throttleRendering){e();return}this.options.throttleRendering&&!this.raf&&(this.raf=requestAnimationFrame(()=>{e(),this.raf=null}))}handleUpdate(e,{silent:n=!1,event:l=!1}={}){if(typeof e!="object"){console.warn("could not set values: invalid values object");return}for(let t in e){let a=this.nodes[t];if(!a)continue;let r=e[t];l||(this.nodes[t]={...a,...r}),"value"in r&&!n&&this.notifySubscribers(t,e[t].value)}this.render()}notifySubscribers(e,n){this.subscribers.get(e)?.forEach(l=>l(n)),this.subscribers.get(He)?.forEach(l=>l(e,n))}subscribe(e,n){let l=typeof e=="string"?e:He,t=typeof n=="function"?n:typeof e=="function"?e:void 0;if(t===void 0){console.warn("could not subscribe: no handler");return}return this.subscribers.has(l)||this.subscribers.set(l,[]),this.subscribers.get(l).push(t),()=>{let a=this.subscribers.get(l),r=a.indexOf(t);r>-1?a.splice(r,1):console.warn("could not unsubscribe: could not find handler")}}set(e,n){let l={};for(let t in e)l[t]={value:e[t]};this.handleUpdate(l,n)}update(e,n){this.handleUpdate(e,{...n,event:!1})}get(){let e={};for(let n in this.nodes){let l=this.nodes[n]?.value;l!==void 0&&(e[n]=l)}return e}destroy(){this.raf&&cancelAnimationFrame(this.raf),ye(null,this.container),this.options.mount||this.container.remove(),this.subscribers.clear(),this.values={}}},Ke={create(e,n={}){let l=Array.isArray(e)?{type:"group",label:"controls",nodes:e}:e,t=new Rn(l,{throttleRendering:!0,injectStyles:!0,classNames:[],...n});return{subscribe:t.subscribe.bind(t),update:t.update.bind(t),set:t.set.bind(t),get:t.get.bind(t),destroy:t.destroy.bind(t)}}};var O=Ke.create({id:"hello, knurl",type:"group",nodes:[{id:"text",type:"text",value:"knurl"},{id:"fontSize",type:"range",label:"font size",value:200,min:100,max:1e3,step:50},{id:"maxBubbles",type:"range",label:"# bubbles",value:380,min:0,max:1e3,step:40},{id:"bubbleRadius",type:"range",label:"radius",value:10,min:0,max:100},{id:"bubbleLifeVariance",type:"range",label:"life variance",value:5,min:0,max:100},{id:"bubbleColor",type:"color",label:"color",value:"#ff0055"},{id:"wind",type:"pad2",value:{x:0,y:-.05}},{id:"shadowColor",type:"color",label:"shadow color",value:"#debaba"},{id:"shadow",type:"pad2",label:"shadow offset",value:{x:10,y:10},minX:-20,maxX:20,minY:-20,maxY:20,scale:.1},{id:"showEvents",type:"toggle",label:"show events",value:!1},{id:"sampleInterval",type:"range",label:"sample interval",value:3,min:1,max:20},{id:"numSamples",type:"display",label:"# samples",value:0}]}),T=document.createElement("canvas"),j=document.createElement("canvas"),D=T.getContext("2d",{willReadFrequently:!0}),H=j.getContext("2d");document.getElementById("canvas-container").append(j);var B=[],$=[],Qe=()=>{T.width=j.width=window.innerWidth,T.height=j.height=window.innerHeight},$n=(e,n,l)=>{D.clearRect(0,0,T.width,T.height),D.font=`${n}px sans-serif`,D.fillStyle="black",D.textAlign="center",D.textBaseline="middle",D.fillText(e,T.width/2,T.height/2),B=[];let t=D.getImageData(0,0,T.width,T.height);for(let a=0;a<T.height;a+=l)for(let r=0;r<T.width;r+=l)t.data[(a*T.width+r)*4+3]>0&&B.push({x:r,y:a});O.set({numSamples:B.length},{silent:!0})},Ze=()=>{let{bubbleLifeVariance:e,shadowColor:n,bubbleColor:l,bubbleRadius:t,maxBubbles:a,wind:r,shadow:u}=O.get();for(H.clearRect(0,0,j.width,j.height);$.length<a&&B.length>0;){let o=B[Math.floor(Math.random()*B.length)];$.push({x:o.x,y:o.y,life:0,maxLife:5+Math.random()*e})}$=$.filter(o=>{o.life+=.1,o.x+=r.x*o.life,o.y+=r.y*o.life;let c=o.life/o.maxLife;return o.radius=Math.sin(c*Math.PI)*t,c<1}),H.fillStyle=n,$.forEach(o=>{H.beginPath(),H.arc(o.x+u.x,o.y+u.y,o.radius,0,2*Math.PI),H.fill()}),H.fillStyle=l,$.forEach(o=>{H.beginPath(),H.arc(o.x,o.y,o.radius,0,2*Math.PI),H.fill()}),requestAnimationFrame(Ze)},fe=document.getElementById("events"),en=e=>{let n=document.createElement("div");n.textContent=`${new Date().toLocaleString("en-US",{})} ${e}`,fe.append(n)},ve=()=>{let{text:e,fontSize:n,sampleInterval:l}=O.get();$n(e,n,l)};Qe();ve();en("use the panel. events will appear here.");window.addEventListener("resize",()=>{Qe(),ve()});O.subscribe((e,n)=>{ve(),en(`${e}: ${JSON.stringify(n)}`)});O.subscribe("showEvents",e=>e?fe.classList.add("show"):fe.classList.remove("show"));Ze();
