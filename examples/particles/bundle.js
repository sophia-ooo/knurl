var ee={},dn={layout:"row",visible:!0},M=(e,n,r={})=>{ee[e]={...dn,...r,component:n}},Fe=e=>e in ee?!0:(console.warn(`control of type "${e}" is requested but not registered`),!1),_n=e=>{if(!Fe(e.type))return;let{component:n,...r}=ee[e.type];return r},hn=e=>{if(!Fe(e.type))return;let{component:n,...r}=ee[e.type];return n},ne,k,Re,fn,F,ye,De,Ue,je,de,se,ce,vn,$={},Be=[],mn=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,te=Array.isArray;function L(e,n){for(var r in n)e[r]=n[r];return e}function _e(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function gn(e,n,r){var t,l,i,o={};for(i in n)i=="key"?t=n[i]:i=="ref"?l=n[i]:o[i]=n[i];if(arguments.length>2&&(o.children=arguments.length>3?ne.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(i in e.defaultProps)o[i]===void 0&&(o[i]=e.defaultProps[i]);return O(e,o,t,l,null)}function O(e,n,r,t,l){var i={type:e,props:n,key:r,ref:t,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:l??++Re,__i:-1,__u:0};return l==null&&k.vnode!=null&&k.vnode(i),i}function R(e){return e.children}function G(e,n){this.props=e,this.context=n}function U(e,n){if(n==null)return e.__?U(e.__,e.__i+1):null;for(var r;n<e.__k.length;n++)if((r=e.__k[n])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?U(e):null}function $e(e){var n,r;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,n=0;n<e.__k.length;n++)if((r=e.__k[n])!=null&&r.__e!=null){e.__e=e.__c.base=r.__e;break}return $e(e)}}function xe(e){(!e.__d&&(e.__d=!0)&&F.push(e)&&!K.__r++||ye!=k.debounceRendering)&&((ye=k.debounceRendering)||De)(K)}function K(){for(var e,n,r,t,l,i,o,u=1;F.length;)F.length>u&&F.sort(Ue),e=F.shift(),u=F.length,e.__d&&(r=void 0,l=(t=(n=e).__v).__e,i=[],o=[],n.__P&&((r=L({},t)).__v=t.__v+1,k.vnode&&k.vnode(r),he(n.__P,r,t,n.__n,n.__P.namespaceURI,32&t.__u?[l]:null,i,l??U(t),!!(32&t.__u),o),r.__v=t.__v,r.__.__k[r.__i]=r,Ve(i,r,o),r.__e!=l&&$e(r)));K.__r=0}function We(e,n,r,t,l,i,o,u,c,s,p){var a,d,_,b,v,g,f=t&&t.__k||Be,m=n.length;for(c=bn(r,n,f,c,m),a=0;a<m;a++)(_=r.__k[a])!=null&&(d=_.__i==-1?$:f[_.__i]||$,_.__i=a,g=he(e,_,d,l,i,o,u,c,s,p),b=_.__e,_.ref&&d.ref!=_.ref&&(d.ref&&fe(d.ref,null,_),p.push(_.ref,_.__c||b,_)),v==null&&b!=null&&(v=b),4&_.__u||d.__k===_.__k?c=qe(_,c,e):typeof _.type=="function"&&g!==void 0?c=g:b&&(c=b.nextSibling),_.__u&=-7);return r.__e=v,c}function bn(e,n,r,t,l){var i,o,u,c,s,p=r.length,a=p,d=0;for(e.__k=new Array(l),i=0;i<l;i++)(o=n[i])!=null&&typeof o!="boolean"&&typeof o!="function"?(c=i+d,(o=e.__k[i]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?O(null,o,null,null,null):te(o)?O(R,{children:o},null,null,null):o.constructor==null&&o.__b>0?O(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=e,o.__b=e.__b+1,u=null,(s=o.__i=kn(o,r,c,a))!=-1&&(a--,(u=r[s])&&(u.__u|=2)),u==null||u.__v==null?(s==-1&&(l>p?d--:l<p&&d++),typeof o.type!="function"&&(o.__u|=4)):s!=c&&(s==c-1?d--:s==c+1?d++:(s>c?d--:d++,o.__u|=4))):e.__k[i]=null;if(a)for(i=0;i<p;i++)(u=r[i])!=null&&(2&u.__u)==0&&(u.__e==t&&(t=U(u)),Ge(u,u));return t}function qe(e,n,r){var t,l;if(typeof e.type=="function"){for(t=e.__k,l=0;t&&l<t.length;l++)t[l]&&(t[l].__=e,n=qe(t[l],n,r));return n}e.__e!=n&&(n&&e.type&&!r.contains(n)&&(n=U(e)),r.insertBefore(e.__e,n||null),n=e.__e);do n=n&&n.nextSibling;while(n!=null&&n.nodeType==8);return n}function kn(e,n,r,t){var l,i,o=e.key,u=e.type,c=n[r];if(c===null&&e.key==null||c&&o==c.key&&u==c.type&&(2&c.__u)==0)return r;if(t>(c!=null&&(2&c.__u)==0?1:0))for(l=r-1,i=r+1;l>=0||i<n.length;){if(l>=0){if((c=n[l])&&(2&c.__u)==0&&o==c.key&&u==c.type)return l;l--}if(i<n.length){if((c=n[i])&&(2&c.__u)==0&&o==c.key&&u==c.type)return i;i++}}return-1}function we(e,n,r){n[0]=="-"?e.setProperty(n,r??""):e[n]=r==null?"":typeof r!="number"||mn.test(n)?r:r+"px"}function V(e,n,r,t,l){var i,o;e:if(n=="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof t=="string"&&(e.style.cssText=t=""),t)for(n in t)r&&n in r||we(e.style,n,"");if(r)for(n in r)t&&r[n]==t[n]||we(e.style,n,r[n])}else if(n[0]=="o"&&n[1]=="n")i=n!=(n=n.replace(je,"$1")),o=n.toLowerCase(),n=o in e||n=="onFocusOut"||n=="onFocusIn"?o.slice(2):n.slice(2),e.l||(e.l={}),e.l[n+i]=r,r?t?r.u=t.u:(r.u=de,e.addEventListener(n,i?ce:se,i)):e.removeEventListener(n,i?ce:se,i);else{if(l=="http://www.w3.org/2000/svg")n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(n!="width"&&n!="height"&&n!="href"&&n!="list"&&n!="form"&&n!="tabIndex"&&n!="download"&&n!="rowSpan"&&n!="colSpan"&&n!="role"&&n!="popover"&&n in e)try{e[n]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&n[4]!="-"?e.removeAttribute(n):e.setAttribute(n,n=="popover"&&r==1?"":r))}}function Ne(e){return function(n){if(this.l){var r=this.l[n.type+e];if(n.t==null)n.t=de++;else if(n.t<r.u)return;return r(k.event?k.event(n):n)}}}function he(e,n,r,t,l,i,o,u,c,s){var p,a,d,_,b,v,g,f,m,S,E,z,P,Y,H,A,B,C=n.type;if(n.constructor!=null)return null;128&r.__u&&(c=!!(32&r.__u),i=[u=n.__e=r.__e]),(p=k.__b)&&p(n);e:if(typeof C=="function")try{if(f=n.props,m="prototype"in C&&C.prototype.render,S=(p=C.contextType)&&t[p.__c],E=p?S?S.props.value:p.__:t,r.__c?g=(a=n.__c=r.__c).__=a.__E:(m?n.__c=a=new C(f,E):(n.__c=a=new G(f,E),a.constructor=C,a.render=xn),S&&S.sub(a),a.props=f,a.state||(a.state={}),a.context=E,a.__n=t,d=a.__d=!0,a.__h=[],a._sb=[]),m&&a.__s==null&&(a.__s=a.state),m&&C.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=L({},a.__s)),L(a.__s,C.getDerivedStateFromProps(f,a.__s))),_=a.props,b=a.state,a.__v=n,d)m&&C.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),m&&a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(m&&C.getDerivedStateFromProps==null&&f!==_&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(f,E),!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(f,a.__s,E)===!1||n.__v==r.__v){for(n.__v!=r.__v&&(a.props=f,a.state=a.__s,a.__d=!1),n.__e=r.__e,n.__k=r.__k,n.__k.some(function(I){I&&(I.__=n)}),z=0;z<a._sb.length;z++)a.__h.push(a._sb[z]);a._sb=[],a.__h.length&&o.push(a);break e}a.componentWillUpdate!=null&&a.componentWillUpdate(f,a.__s,E),m&&a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(_,b,v)})}if(a.context=E,a.props=f,a.__P=e,a.__e=!1,P=k.__r,Y=0,m){for(a.state=a.__s,a.__d=!1,P&&P(n),p=a.render(a.props,a.state,a.context),H=0;H<a._sb.length;H++)a.__h.push(a._sb[H]);a._sb=[]}else do a.__d=!1,P&&P(n),p=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++Y<25);a.state=a.__s,a.getChildContext!=null&&(t=L(L({},t),a.getChildContext())),m&&!d&&a.getSnapshotBeforeUpdate!=null&&(v=a.getSnapshotBeforeUpdate(_,b)),A=p,p!=null&&p.type===R&&p.key==null&&(A=Oe(p.props.children)),u=We(e,te(A)?A:[A],n,r,t,l,i,o,u,c,s),a.base=n.__e,n.__u&=-161,a.__h.length&&o.push(a),g&&(a.__E=a.__=null)}catch(I){if(n.__v=null,c||i!=null)if(I.then){for(n.__u|=c?160:128;u&&u.nodeType==8&&u.nextSibling;)u=u.nextSibling;i[i.indexOf(u)]=null,n.__e=u}else for(B=i.length;B--;)_e(i[B]);else n.__e=r.__e,n.__k=r.__k;k.__e(I,n,r)}else i==null&&n.__v==r.__v?(n.__k=r.__k,n.__e=r.__e):u=n.__e=yn(r.__e,n,r,t,l,i,o,c,s);return(p=k.diffed)&&p(n),128&n.__u?void 0:u}function Ve(e,n,r){for(var t=0;t<r.length;t++)fe(r[t],r[++t],r[++t]);k.__c&&k.__c(n,e),e.some(function(l){try{e=l.__h,l.__h=[],e.some(function(i){i.call(l)})}catch(i){k.__e(i,l.__v)}})}function Oe(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:te(e)?e.map(Oe):L({},e)}function yn(e,n,r,t,l,i,o,u,c){var s,p,a,d,_,b,v,g=r.props,f=n.props,m=n.type;if(m=="svg"?l="http://www.w3.org/2000/svg":m=="math"?l="http://www.w3.org/1998/Math/MathML":l||(l="http://www.w3.org/1999/xhtml"),i!=null){for(s=0;s<i.length;s++)if((_=i[s])&&"setAttribute"in _==!!m&&(m?_.localName==m:_.nodeType==3)){e=_,i[s]=null;break}}if(e==null){if(m==null)return document.createTextNode(f);e=document.createElementNS(l,m,f.is&&f),u&&(k.__m&&k.__m(n,i),u=!1),i=null}if(m==null)g===f||u&&e.data==f||(e.data=f);else{if(i=i&&ne.call(e.childNodes),g=r.props||$,!u&&i!=null)for(g={},s=0;s<e.attributes.length;s++)g[(_=e.attributes[s]).name]=_.value;for(s in g)if(_=g[s],s!="children"){if(s=="dangerouslySetInnerHTML")a=_;else if(!(s in f)){if(s=="value"&&"defaultValue"in f||s=="checked"&&"defaultChecked"in f)continue;V(e,s,null,_,l)}}for(s in f)_=f[s],s=="children"?d=_:s=="dangerouslySetInnerHTML"?p=_:s=="value"?b=_:s=="checked"?v=_:u&&typeof _!="function"||g[s]===_||V(e,s,_,g[s],l);if(p)u||a&&(p.__html==a.__html||p.__html==e.innerHTML)||(e.innerHTML=p.__html),n.__k=[];else if(a&&(e.innerHTML=""),We(n.type=="template"?e.content:e,te(d)?d:[d],n,r,t,m=="foreignObject"?"http://www.w3.org/1999/xhtml":l,i,o,i?i[0]:r.__k&&U(r,0),u,c),i!=null)for(s=i.length;s--;)_e(i[s]);u||(s="value",m=="progress"&&b==null?e.removeAttribute("value"):b!=null&&(b!==e[s]||m=="progress"&&!b||m=="option"&&b!=g[s])&&V(e,s,b,g[s],l),s="checked",v!=null&&v!=e[s]&&V(e,s,v,g[s],l))}return e}function fe(e,n,r){try{if(typeof e=="function"){var t=typeof e.__u=="function";t&&e.__u(),t&&n==null||(e.__u=e(n))}else e.current=n}catch(l){k.__e(l,r)}}function Ge(e,n,r){var t,l;if(k.unmount&&k.unmount(e),(t=e.ref)&&(t.current&&t.current!=e.__e||fe(t,null,n)),(t=e.__c)!=null){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(i){k.__e(i,n)}t.base=t.__P=null}if(t=e.__k)for(l=0;l<t.length;l++)t[l]&&Ge(t[l],n,r||typeof e.type!="function");r||_e(e.__e),e.__c=e.__=e.__e=void 0}function xn(e,n,r){return this.constructor(e,r)}function Se(e,n,r){var t,l,i,o;n==document&&(n=document.documentElement),k.__&&k.__(e,n),l=(t=typeof r=="function")?null:r&&r.__k||n.__k,i=[],o=[],he(n,e=(!t&&r||n).__k=gn(R,null,[e]),l||$,$,n.namespaceURI,!t&&r?[r]:l?null:n.firstChild?ne.call(n.childNodes):null,i,!t&&r?r:l?l.__e:n.firstChild,t,o),Ve(i,e,o)}ne=Be.slice,k={__e:function(e,n,r,t){for(var l,i,o;n=n.__;)if((l=n.__c)&&!l.__)try{if((i=l.constructor)&&i.getDerivedStateFromError!=null&&(l.setState(i.getDerivedStateFromError(e)),o=l.__d),l.componentDidCatch!=null&&(l.componentDidCatch(e,t||{}),o=l.__d),o)return l.__E=l}catch(u){e=u}throw e}},Re=0,fn=function(e){return e!=null&&e.constructor==null},G.prototype.setState=function(e,n){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=L({},this.state),typeof e=="function"&&(e=e(L({},r),this.props)),e&&L(r,e),e!=null&&this.__v&&(n&&this._sb.push(n),xe(this))},G.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),xe(this))},G.prototype.render=R,F=[],De=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ue=function(e,n){return e.__v.__b-n.__v.__b},K.__r=0,je=/(PointerCapture)$|Capture$/i,de=0,se=Ne(!1),ce=Ne(!0),vn=0;var wn=0,et=Array.isArray;function h(e,n,r,t,l,i){n||(n={});var o,u,c=n;if("ref"in c)for(u in c={},n)u=="ref"?o=n[u]:c[u]=n[u];var s={type:e,props:c,key:r,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--wn,__i:-1,__u:0,__source:l,__self:i};if(typeof e=="function"&&(o=e.defaultProps))for(u in o)c[u]===void 0&&(c[u]=o[u]);return k.vnode&&k.vnode(s),s}var Nn=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id];return h("button",{type:"button",onClick:()=>r({[t.id]:{value:!0}},{event:!0}),children:t.text??t.id})};M("button",Nn,{label:null});var W,y,ue,Ee,Q=0,Je=[],x=k,Te=x.__b,ze=x.__r,Ce=x.diffed,Me=x.__c,Pe=x.unmount,Ae=x.__;function ve(e,n){x.__h&&x.__h(y,e,Q||n),Q=0;var r=y.__H||(y.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function X(e){return Q=1,Sn(Qe,e)}function Sn(e,n,r){var t=ve(W++,2);if(t.t=e,!t.__c&&(t.__=[r?r(n):Qe(void 0,n),function(u){var c=t.__N?t.__N[0]:t.__[0],s=t.t(c,u);c!==s&&(t.__N=[s,t.__[1]],t.__c.setState({}))}],t.__c=y,!y.__f)){var l=function(u,c,s){if(!t.__c.__H)return!0;var p=t.__c.__H.__.filter(function(d){return!!d.__c});if(p.every(function(d){return!d.__N}))return!i||i.call(this,u,c,s);var a=t.__c.props!==u;return p.forEach(function(d){if(d.__N){var _=d.__[0];d.__=d.__N,d.__N=void 0,_!==d.__[0]&&(a=!0)}}),i&&i.call(this,u,c,s)||a};y.__f=!0;var i=y.shouldComponentUpdate,o=y.componentWillUpdate;y.componentWillUpdate=function(u,c,s){if(this.__e){var p=i;i=void 0,l(u,c,s),i=p}o&&o.call(this,u,c,s)},y.shouldComponentUpdate=l}return t.__N||t.__}function j(e,n){var r=ve(W++,3);!x.__s&&Ke(r.__H,n)&&(r.__=e,r.u=n,y.__H.__h.push(r))}function En(e){return Q=5,Tn(function(){return{current:e}},[])}function Tn(e,n){var r=ve(W++,7);return Ke(r.__H,n)&&(r.__=e(),r.__H=n,r.__h=e),r.__}function zn(){for(var e;e=Je.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(J),e.__H.__h.forEach(pe),e.__H.__h=[]}catch(n){e.__H.__h=[],x.__e(n,e.__v)}}x.__b=function(e){y=null,Te&&Te(e)},x.__=function(e,n){e&&n.__k&&n.__k.__m&&(e.__m=n.__k.__m),Ae&&Ae(e,n)},x.__r=function(e){ze&&ze(e),W=0;var n=(y=e.__c).__H;n&&(ue===y?(n.__h=[],y.__h=[],n.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(n.__h.forEach(J),n.__h.forEach(pe),n.__h=[],W=0)),ue=y},x.diffed=function(e){Ce&&Ce(e);var n=e.__c;n&&n.__H&&(n.__H.__h.length&&(Je.push(n)!==1&&Ee===x.requestAnimationFrame||((Ee=x.requestAnimationFrame)||Cn)(zn)),n.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),ue=y=null},x.__c=function(e,n){n.some(function(r){try{r.__h.forEach(J),r.__h=r.__h.filter(function(t){return!t.__||pe(t)})}catch(t){n.some(function(l){l.__h&&(l.__h=[])}),n=[],x.__e(t,r.__v)}}),Me&&Me(e,n)},x.unmount=function(e){Pe&&Pe(e);var n,r=e.__c;r&&r.__H&&(r.__H.__.forEach(function(t){try{J(t)}catch(l){n=l}}),r.__H=void 0,n&&x.__e(n,r.__v))};var Le=typeof requestAnimationFrame=="function";function Cn(e){var n,r=function(){clearTimeout(t),Le&&cancelAnimationFrame(n),setTimeout(e)},t=setTimeout(r,35);Le&&(n=requestAnimationFrame(r))}function J(e){var n=y,r=e.__c;typeof r=="function"&&(e.__c=void 0,r()),y=n}function pe(e){var n=y;e.__c=e.__(),y=n}function Ke(e,n){return!e||e.length!==n.length||n.some(function(r,t){return r!==e[t]})}function Qe(e,n){return typeof n=="function"?n(e):n}var Xe=e=>e.trim()==="",Ye=e=>isFinite(e),Mn=(e,n)=>String(e)!==n,Pn=(e,n,r)=>e>=n&&e<=r,An=(e,n,r)=>Math.min(Math.max(e,n),r),Z=({value:e,min:n=-1/0,max:r=1/0,commit:t})=>{let[l,i]=X(String(e)),[o,u]=X(e);j(()=>{i(String(e)),u(e)},[e]);function c(p){let a=String(p);if(i(a),Xe(a))return;let d=Number(a);!Ye(d)||!Pn(d,n,r)||Mn(d,a)||(u(d),t(d))}function s(){if(Xe(l)||!Ye(Number(l))){i(String(o));return}let p=Number(l),a=An(p,n,r);i(String(a)),u(a),t(a)}return{value:e,text:l,setValue:c,handleBlur:s}},re=e=>Array.isArray(e)&&e.every(n=>n!=null&&typeof n=="object"&&!Array.isArray(n)&&"label"in n&&"value"in n)?e:Array.isArray(e)?e.map(n=>({label:String(n),value:n})):e&&typeof e=="object"?Object.entries(e).map(([n,r])=>({label:n,value:r})):[],Ln=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id],l=re(t.options).map(({label:i,value:o},u)=>{let c=t.value===o?"knurl-selected":"";return h("button",{onClick:()=>r({[t.id]:{value:o}}),className:`${c}`,type:"button",children:i},i)});return h("div",{className:"knurl-buttons",children:l})};M("buttons",Ln,{value:e=>re(e.options)[0]?.value});var Xn=e=>"#ffffff",Yn=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id],[l,i]=X(t.value),[o,u]=X(t.value);j(()=>{i(t.value)},[t.value]);let c=a=>a.startsWith("#")&&a.length===7&&CSS.supports("color",a),s=a=>{let d=a.currentTarget.value,_=c(d)?d:o;r({[t.id]:{value:_}}),i(_)},p=a=>{let d=a.currentTarget.value;c(d)&&(r({[t.id]:{value:d}}),u(d))};return h(R,{children:[h("input",{type:"color",value:l,onInput:p,className:"knurl-color-picker"}),h("input",{type:"text",className:"knurl-fixed",size:"7",value:l,onInput:p,onChange:s})]})};M("color",Yn,{value:Xn});var Hn=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id];switch(t.format){case"monospace":return h("span",{className:"knurl-display knurl-monospace",children:t.value});case"block":return h("pre",{className:"knurl-display knurl-monospace",children:t.value});case"html":return h("span",{className:"knurl-display",dangerouslySetInnerHTML:{__html:t.value??""}});default:return h("span",{className:"knurl-display",children:t.value})}};M("display",Hn,{value:"",format:"text"});var In=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id],l=En(null),[i,o]=X(Array(t.samples).fill(0)),[u,c]=X({min:null,max:null});return j(()=>{o(s=>[...s,t.value].slice(-t.samples)),c(s=>({min:s.min===null?t.value:Math.min(s.min,t.value),max:s.max===null?t.value:Math.max(s.max,t.value)}))},[t]),j(()=>{let s=l.current;if(!s)return;let p=s.getContext("2d"),a=s.getBoundingClientRect(),d=window.devicePixelRatio||1,_=a.width,b=t.height;s.width=_*d,s.height=b*d,p.scale(d,d),s.style.width=_+"px",s.style.height=b+"px",p.clearRect(0,0,_,b);let v=s.closest(".knurl"),g=getComputedStyle(v).getPropertyValue("--panel-fg").trim()||"#aaa",f=t.min??u.min??0,m=t.max??u.max??1,S=m-f||1,E=1/(t.samples-1)*_;p.fillStyle=g,p.globalAlpha=.5,p.beginPath(),p.moveTo(0,b),i.forEach((z,P)=>{let Y=(z-f)/S*b,H=P*E,A=b-Y;p.lineTo(H,A)}),p.lineTo(_,b),p.fill(),p.globalAlpha=1,p.font="10px ui-monospace, monospace",p.textBaseline="top",p.textAlign="left",p.fillText(m,3,0),p.textBaseline="bottom",p.fillText(f,3,b)},[i,u,t]),h("canvas",{className:"knurl-graph",ref:l,height:t.height})};M("graph",In,{height:60,samples:60});var Ze=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id];if(!t.visible)return null;let l=hn(t);if(!l)return null;let i=h(l,{nodes:e,treeNode:n,update:r});if(t.layout==="block")return i;let o=!(t.label===""||t.label===null);return h("div",{className:"knurl-row",role:"group","aria-label":t.label??t.id,children:[o&&h("span",{className:"knurl-label",children:t.label??t.id}),h("div",{className:"knurl-control",children:i})]})},Fn=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id],l=n.nodes.map((c,s)=>h(Ze,{nodes:e,treeNode:c,update:r},c.id)),i=t.expanded?"knurl-expanded":"knurl-collapsed",o=t.showLabel?"knurl-show-label":"knurl-hide-label",u=!(t.label===""||t.label===null);return h("div",{className:`knurl-group ${i} ${o}`,children:[u&&h("span",{className:"knurl-label",onClick:()=>{t.expandable&&r({[t.id]:{expanded:!t.expanded}})},children:[t.expandable&&h("span",{className:"knurl-icon",children:"\u2303"}),t.label??t.id]}),h("div",{className:"knurl-group-container",children:l})]})};M("group",Fn,{layout:"block",expandable:!0,expanded:!0});var Rn=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id],{text:l,setValue:i,handleBlur:o}=Z({value:t.value,min:t.min,max:t.max,commit:u=>r({[t.id]:{value:u}})});return h("input",{className:"knurl-number-input",type:"text",value:l,onInput:u=>i(u.currentTarget.value),onChange:o})};M("number",Rn,{value:()=>0});var He=(e,n)=>{let r=1/n;return Math.round(e*r)/r},Dn=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id],{x:l,y:i}=t.value,[o,u]=X(!1),[c,s]=X(null),[p,a]=X({height:176,width:176,space:6,radius:2});j(()=>{let v=document.querySelector(".knurl");if(!v)return;let g=getComputedStyle(v),f=g.getPropertyValue("--panel-width"),m=g.getPropertyValue("--label-width"),S=g.getPropertyValue("--panel-radius"),E=g.getPropertyValue("--panel-space"),z=parseFloat(f)-parseFloat(m)-2*parseFloat(E),P=parseFloat(S),Y=parseFloat(E);a({width:z,height:z,radius:P,space:Y})},[]);let d=Z({value:t.value.x,min:t.minX,max:t.maxX,commit:v=>r({[t.id]:{value:{...t.value,x:v}}})}),_=Z({value:t.value.y,min:t.minY,max:t.maxY,commit:v=>r({[t.id]:{value:{...t.value,y:v}}})});j(()=>{if(!o||!c)return;let v=document.body.style.cursor;document.body.style.cursor="grabbing";let g=S=>{let E=S.clientX??S.touches?.[0]?.clientX,z=S.clientY??S.touches?.[0]?.clientY;if(E===void 0||z===void 0)return;let P=E-c.pointerX,Y=z-c.pointerY,H=c.valueX+P*t.scale,A=c.valueY+Y*t.scale,B=Math.max(t.minX,Math.min(t.maxX,H)),C=Math.max(t.minY,Math.min(t.maxY,A)),I=He(B,t.step),pn=He(C,t.step);r({[t.id]:{value:{x:I,y:pn}}})},f=()=>{u(!1),s(null)},m=S=>(S.preventDefault(),!1);return document.addEventListener("mousemove",g),document.addEventListener("mouseup",f),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",f),()=>{document.body.style.cursor=v,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",f)}},[o,c,t]);let b=(v,g=null)=>{let f=v.clientX??v.touches?.[0]?.clientX,m=v.clientY??v.touches?.[0]?.clientY;u(!0),s({pointerX:f,pointerY:m,valueX:g?.x??t.value.x,valueY:g?.y??t.value.y})};return h(R,{children:[h("button",{onMouseDown:v=>{v.preventDefault(),b(v)},onTouchStart:v=>{v.preventDefault(),b(v)},className:`knurl-translate ${o?"knurl-selected":""}`,type:"button",style:{touchAction:"none",userSelect:"none"},children:"\u2316"}),h("input",{className:"knurl-number-input knurl-fixed",type:"text",size:"7",value:d.text,onInput:v=>d.setValue(v.currentTarget.value),onChange:d.handleBlur}),h("input",{className:"knurl-number-input knurl-fixed",type:"text",size:"7",value:_.text,onInput:v=>_.setValue(v.currentTarget.value),onChange:_.handleBlur}),o&&h("div",{className:"knurl-pad2",children:h("svg",{width:p.width,height:p.height,style:{position:"absolute",top:0,left:0,borderRadius:p.radius},children:[h("rect",{width:p.width,height:p.height,fill:"transparent",className:"knurl-border",rx:p.radius}),h("line",{x1:p.width/2,y1:0,x2:p.width/2,y2:p.height,className:"knurl-grid"}),h("line",{x1:0,y1:p.height/2,x2:p.width,y2:p.height/2,className:"knurl-grid"}),h("text",{x:p.space,y:p.space,className:"knurl-label","dominant-baseline":"hanging","font-size":"10",children:[t.minX,",",t.minY]}),h("text",{x:p.width-p.space,y:p.space,"dominant-baseline":"hanging",className:"knurl-label","font-size":"10","text-anchor":"end",children:[t.maxX,",",t.minY]}),h("text",{x:p.space,y:p.height-p.space,className:"knurl-label","font-size":"10",children:[t.minX,",",t.maxY]}),h("text",{x:p.width-p.space,y:p.height-p.space,className:"knurl-label","font-size":"10","text-anchor":"end",children:[t.maxX,",",t.maxY]}),h("circle",{cx:(l-t.minX)/(t.maxX-t.minX)*p.width,cy:(i-t.minY)/(t.maxY-t.minY)*p.height,r:6,className:"knurl-indicator"})]})})]})};M("pad2",Dn,{value:e=>({x:e.minX+(e.maxX-e.minX)*.5,y:e.minY+(e.maxY-e.minY)*.5}),scale:.01,step:.01,minX:-1,maxX:1,minY:-1,maxY:1});var Un=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id],{text:l,setValue:i,handleBlur:o}=Z({value:t.value,min:t.min,max:t.max,commit:u=>r({[t.id]:{value:u}})});return h(R,{children:[h("input",{type:"range",value:l,min:t.min,max:t.max,step:t.step??1,onInput:u=>i(u.currentTarget.value)}),h("input",{type:"text",size:"7",className:"knurl-number-input knurl-fixed",value:l,onInput:u=>i(u.currentTarget.value),onChange:o})]})};M("range",Un,{value:e=>e.min??0});var jn=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id],l=re(t.options),i=c=>{let s=Number(c.currentTarget.value),p=l[s].value;r({[t.id]:{value:p}})},o=l.map(({label:c},s)=>h("option",{value:s,children:c},c)),u=l.findIndex(({value:c})=>c===t.value);return h("select",{value:u<0?"":u,onChange:i,children:o})};M("select",jn,{value:e=>re(e.options)[0]?.value});var Bn=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id],l=i=>{r({[t.id]:{value:i.currentTarget.value}})};return t.rows>1?h("textarea",{value:t.value,onInput:l,rows:t.rows}):h("input",{type:"text",value:t.value,onInput:l})};M("text",Bn,{value:"",rows:1});var $n=({nodes:e,treeNode:n,update:r})=>{let t=e[n.id];return h("input",{type:"checkbox",checked:t.value,onInput:l=>r({[t.id]:{value:l.currentTarget.checked}})})};M("toggle",$n,{value:e=>!1});var Wn='.knurl-container{position:fixed;top:0;right:0}.knurl{--panel-bg: hsl(230 7% 10%);--panel-fg: hsl(230 10% 75%);--panel-border: hsl(230 9% 18%);--panel-hover: hsl(230 9% 26%);--panel-pressed: hsl(230 7% 16%);--panel-low-emphasis: hsl(230 4% 55%);--panel-focus: var(--panel-fg);--panel-selection-fg: var(--panel-bg);--panel-selection-bg: var(--panel-fg);--value-number: hsl(220 80% 65%);--value-string: hsl(139 45% 56%);--panel-space: 4px;--panel-radius: 2px;--panel-width: 256px;--label-width: 80px;--row-height: 20px;--font-ui: system-ui, -apple-system, sans-serif;--font-value: ui-monospace, monospace;--font-size-normal: 11px;--line-height-normal: 1.4;--color-link: var(--value-number);--panel-tween-func: cubic-bezier(.25, .8, .5, 1);--panel-tween-duration: .2s;--checkbox-check-width: 3px;--checkbox-check-height: 9px;width:var(--panel-width);color:var(--panel-fg);font-family:var(--font-ui);font-size:var(--font-size-normal);line-height:var(--line-height-normal);box-sizing:border-box;font-variant-numeric:tabular-nums}.knurl .knurl-row{display:flex;flex-direction:row;gap:var(--panel-space);padding:var(--panel-space) var(--panel-space)}.knurl .knurl-row+.knurl-row{padding-top:calc(var(--panel-space) * .5)}.knurl .knurl-row:has(+.knurl-row){padding-bottom:calc(var(--panel-space) * .5)}.knurl .knurl-group-container .knurl-group-container{border-bottom:1px solid var(--panel-border)}.knurl .knurl-row .knurl-label{display:flex;align-self:flex-start;align-items:center;line-height:1.2;min-height:20px;min-width:0;user-select:none;color:var(--panel-low-emphasis);flex:0 0 var(--label-width)}.knurl .knurl-group{display:flex;flex-direction:column;background:var(--panel-bg);border-radius:var(--panel-radius)}.knurl-container>.knurl>.knurl-group>.knurl-label{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.knurl .knurl-group>.knurl-label{display:flex;align-items:center;user-select:none;background:var(--panel-border);border-radius:var(--panel-radius);height:var(--row-height);padding-left:var(--panel-space);gap:var(--panel-space)}.knurl .knurl-group>.knurl-label:has(>.knurl-icon){cursor:pointer}.knurl .knurl-group>.knurl-label>.knurl-icon{font-weight:700;font-size:10px;cursor:pointer}@media (prefers-reduced-motion: no-preference){.knurl .knurl-group>.knurl-label>.knurl-icon{transition:transform var(--panel-tween-duration) var(--panel-tween-func)}}.knurl .knurl-group.knurl-expanded>.knurl-label>.knurl-icon{transform:rotate(180deg)}.knurl .knurl-group>.knurl-group-container{flex-direction:column;overflow:hidden;display:none}.knurl .knurl-group.knurl-expanded>.knurl-group-container{display:flex}@supports (interpolate-size: allow-keywords){.knurl .knurl-group>.knurl-group-container{display:flex;interpolate-size:allow-keywords;height:0;opacity:0}@media (prefers-reduced-motion: no-preference){.knurl .knurl-group>.knurl-group-container{transition:height var(--panel-tween-duration) var(--panel-tween-func),padding var(--panel-tween-duration) var(--panel-tween-func),opacity var(--panel-tween-duration) var(--panel-tween-func)}}.knurl .knurl-group.knurl-expanded>.knurl-group-container{height:auto;opacity:1}}.knurl-container>.knurl{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.knurl .knurl-row .knurl-control{flex:1 1 auto;display:flex;justify-content:flex-start;align-items:center;min-height:var(--row-height);gap:var(--panel-space)}.knurl button,.knurl input,.knurl select,.knurl textarea{font-size:inherit;font-family:inherit;width:100%;box-sizing:border-box;border:1px solid transparent;padding:0 var(--panel-space);border-radius:var(--panel-radius);background:var(--panel-border);color:var(--panel-fg)}.knurl button,.knurl select,.knurl input[type=text],.knurl input[type=range]{min-height:var(--row-height)}.knurl input[type=color]{height:var(--row-height)}.knurl button,.knurl select,.knurl input[type=checkbox],.knurl input[type=range],.knurl input[type=color]{cursor:pointer}.knurl input[type=text],.knurl textarea{cursor:text}.knurl button:focus-visible,.knurl select:focus-visible,.knurl input:focus-visible,.knurl textarea:focus-visible{outline:2px solid var(--panel-focus);outline-offset:0px}.knurl button:focus:not(:focus-visible),.knurl select:focus:not(:focus-visible),.knurl input:focus:not(:focus-visible),.knurl textarea:focus:not(:focus-visible){outline:none}.knurl button:hover:not(:active):not(.knurl-selected),.knurl input:hover,.knurl select:hover,.knurl textarea:hover{background:var(--panel-hover)}.knurl button:active,.knurl button.knurl-selected{background:var(--panel-fg);color:var(--panel-bg);border-radius:var(--panel-radius)}.knurl input::selection,.knurl textarea::selection{background:var(--panel-selection-bg);color:var(--panel-selection-fg)}.knurl textarea{resize:vertical;min-height:calc(var(--row-height) * 2 + var(--panel-space));line-height:var(--line-height-normal);color:var(--value-string);font-family:var(--font-value)}.knurl .knurl-buttons{display:flex;flex-direction:row;flex:1;gap:var(--panel-space)}.knurl .knurl-pad2{position:absolute;align-self:flex-start;margin-top:calc(var(--row-height) + var(--panel-space));width:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));height:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));background:var(--panel-bg);z-index:1001}.knurl .knurl-pad2 .knurl-border,.knurl .knurl-pad2 .knurl-grid{stroke:var(--panel-fg);stroke-opacity:.25}.knurl .knurl-pad2 .knurl-label{fill:var(--panel-fg);opacity:.5}.knurl .knurl-pad2 .knurl-indicator{fill:var(--panel-fg)}.knurl button.knurl-translate{font-weight:bolder}.knurl button.knurl-translate.knurl-selected{cursor:grabbing}.knurl input[type=text]{color:var(--value-string);font-family:var(--font-value)}.knurl input[type=text].knurl-number-input{color:var(--value-number)}.knurl input[type=number]::-webkit-inner-spin-button,.knurl input[type=number]::-webkit-outer-spin-button{appearance:none;margin:0}.knurl input[type=text].knurl-fixed{width:60px}.knurl .knurl-control>.knurl-display{line-height:var(--row-height)}.knurl .knurl-control>.knurl-display.knurl-monospace{font-family:var(--font-value)}.knurl .knurl-display a{color:var(--color-link);text-decoration:underline}.knurl .knurl-display a:hover{text-decoration:none}.knurl pre.knurl-display{margin:0}.knurl input[type=checkbox]{margin:0;appearance:none;border-radius:var(--panel-radius);width:14px;height:14px;text-align:center}.knurl input[type=checkbox]:checked:before{content:"";display:flex;height:var(--checkbox-check-height);width:var(--checkbox-check-width);border-bottom:2px solid var(--panel-fg);border-right:2px solid var(--panel-fg);transform:rotate(45deg)}.knurl input[type=range]{-webkit-appearance:none;appearance:none;background:transparent;margin:0;padding:0}.knurl input[type=range]::-webkit-slider-runnable-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.knurl input[type=range]::-moz-range-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.knurl input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);margin-top:-4px}.knurl input[type=range]::-moz-range-thumb{width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);border:none}.knurl input[type=color]{-webkit-appearance:none;border:1px solid var(--panel-border);padding:0;border-radius:var(--panel-radius);height:var(--row-height)}.knurl input[type=color]::-webkit-color-swatch-wrapper{padding:0}.knurl input[type=color]::-webkit-color-swatch{border:0}.knurl canvas.knurl-graph{width:100%}',qn=0,Vn=e=>`node ${qn++}`,en=e=>{let{id:n=Vn(),nodes:r=[],...t}=e,l={},i={id:n,nodes:[]},o={id:n},u=_n(e);for(let c in u)typeof u[c]=="function"?o[c]=u[c]({...u,...e}):o[c]=u[c];return Object.assign(o,t),l[n]=o,r.length>0&&r.forEach(c=>{let[s,p]=en(c);Object.assign(l,s),i.nodes.push(p)}),[l,i]},On=()=>{let e=document.createElement("div");return e.classList.add("knurl-container"),document.body.append(e),e},Gn=()=>{if(!document.querySelector("style[data-knurl]")){let e=document.createElement("style");e.textContent=Wn,e.setAttribute("data-knurl","true"),document.head.appendChild(e)}},Ie=Symbol("all"),Jn=class{constructor(e,n){let[r,t]=en(e);this.nodes=r,this.root=t,this.container=n.mount??On(),this.options=n,this.subscribers=new Map,this.raf=null,n.injectStyles&&Gn(),this.render()}render(){let e=()=>{Se(h("div",{className:`knurl ${this.options.classNames.join(" ")}`,children:h(Ze,{nodes:this.nodes,treeNode:this.root,update:this.handleUpdate.bind(this)})}),this.container)};if(!this.options.throttleRendering){e();return}this.options.throttleRendering&&!this.raf&&(this.raf=requestAnimationFrame(()=>{e(),this.raf=null}))}handleUpdate(e,{silent:n=!1,event:r=!1}={}){if(typeof e!="object"){console.warn("could not set values: invalid values object");return}for(let t in e){let l=this.nodes[t];if(!l)continue;let i=e[t];r||(this.nodes[t]={...l,...i}),"value"in i&&!n&&this.notifySubscribers(t,e[t].value)}this.render()}notifySubscribers(e,n){this.subscribers.get(e)?.forEach(r=>r(n)),this.subscribers.get(Ie)?.forEach(r=>r(e,n))}subscribe(e,n){let r=typeof e=="string"?e:Ie,t=typeof n=="function"?n:typeof e=="function"?e:void 0;if(t===void 0){console.warn("could not subscribe: no handler");return}return this.subscribers.has(r)||this.subscribers.set(r,[]),this.subscribers.get(r).push(t),()=>{let l=this.subscribers.get(r),i=l.indexOf(t);i>-1?l.splice(i,1):console.warn("could not unsubscribe: could not find handler")}}set(e,n){let r={};for(let t in e)r[t]={value:e[t]};this.handleUpdate(r,n)}update(e,n){this.handleUpdate(e,{...n,event:!1})}get(){let e={};for(let n in this.nodes){let r=this.nodes[n]?.value;r!==void 0&&(e[n]=r)}return e}destroy(){this.raf&&cancelAnimationFrame(this.raf),Se(null,this.container),this.options.mount||this.container.remove(),this.subscribers.clear(),this.values={}}},nn={create(e,n={}){let r=Array.isArray(e)?{type:"group",label:"controls",nodes:e}:e,t=new Jn(r,{throttleRendering:!0,injectStyles:!0,classNames:[],...n});return{subscribe:t.subscribe.bind(t),update:t.update.bind(t),set:t.set.bind(t),get:t.get.bind(t),destroy:t.destroy.bind(t)}}};var rn=200,le=300,Kn={slow:{color:"rgba(0, 0, 0, 1)",speed:1,size:8},fast:{color:"rgba(255, 0, 110, 1)",speed:3,size:5},heavy:{color:"rgba(0, 102, 255, 1)",speed:.5,size:12}},w={gravity:.1,bounce:.8,friction:.99,spawnRate:2,burstSize:50},D=nn.create({id:"particles",type:"group",nodes:[{id:"total",type:"graph",label:"total",min:0,max:rn},{id:"velocity",type:"graph",label:"avg velocity",min:0,max:10},{id:"collisions",type:"graph",label:"collisions/s"},{type:"group",label:"physics",expanded:!0,nodes:[{id:"gravity",type:"range",label:"gravity",min:-.5,max:.5,step:.01,value:w.gravity},{id:"bounce",type:"range",label:"bounce",min:0,max:1,step:.01,value:w.bounce},{id:"friction",type:"range",label:"friction",min:.9,max:1,step:.001,value:w.friction}]},{type:"group",label:"spawn",expanded:!0,nodes:[{id:"spawnRate",type:"range",label:"flow rate",min:1,max:5,step:1,value:w.spawnRate},{id:"spawnType",type:"toggle-group",label:"type",value:"slow",options:["slow","fast","heavy"]},{type:"button",id:"burst",text:"\u{1F4A5}"},{type:"button",id:"reset",text:"reset"}]}]}),ge=class{constructor(n,r,t){let l=Kn[t];this.x=n,this.y=r,this.vx=(Math.random()-.5)*l.speed*4,this.vy=(Math.random()-.5)*l.speed*4,this.type=t,this.size=l.size,this.color=l.color,this.collided=!1,this.age=0}update(n){return this.age++,this.age>le||(this.vy+=w.gravity,this.vx*=w.friction,this.vy*=w.friction,this.x+=this.vx,this.y+=this.vy,(this.x-this.size<0||this.x+this.size>n.width)&&(this.x=Math.max(this.size,Math.min(n.width-this.size,this.x)),this.vx*=-w.bounce),(this.y-this.size<0||this.y+this.size>n.height)&&(this.y=Math.max(this.size,Math.min(n.height-this.size,this.y)),this.vy*=-w.bounce,this.y+this.size>=n.height&&(this.vx*=.9)),Math.sqrt(this.vx*this.vx+this.vy*this.vy)<.1&&this.y+this.size>=n.height-1)?!1:(this.collided=!1,!0)}checkCollision(n){let r=n.x-this.x,t=n.y-this.y,l=Math.sqrt(r*r+t*t),i=this.size+n.size;if(l<i&&l>0){let o=Math.atan2(t,r),u=this.x+Math.cos(o)*i,c=this.y+Math.sin(o)*i,s=(u-n.x)*.1,p=(c-n.y)*.1;return this.vx-=s,this.vy-=p,n.vx+=s,n.vy+=p,this.collided=!0,n.collided=!0,!0}return!1}draw(n){let r=this.age>le*.8?(le-this.age)/(le*.2):1;n.fillStyle=this.color.replace("1)",`${r})`),n.beginPath(),n.arc(this.x,this.y,this.size,0,2*Math.PI),n.fill(),this.collided&&(n.strokeStyle=`rgba(255, 255, 255, ${.8*r})`,n.lineWidth=2,n.stroke())}getSpeed(){return Math.sqrt(this.vx*this.vx+this.vy*this.vy)}},T=[];var q=[],ae=!1,be=0,ke=0,N=document.createElement("canvas"),me=N.getContext("2d"),Qn=document.getElementById("canvas-container"),tn=document.getElementById("prompt");Qn.appendChild(N);var ln=()=>tn&&tn.remove(),an=()=>{N.width=window.innerWidth,N.height=window.innerHeight},on=e=>{let n=N.getBoundingClientRect();return e.touches&&e.touches.length>0?{x:e.touches[0].clientX-n.left,y:e.touches[0].clientY-n.top}:{x:e.clientX-n.left,y:e.clientY-n.top}},ie=(e,n,r,t)=>{for(;T.length+r>rn;)T.shift();for(let l=0;l<r;l++){let i=Math.random()*Math.PI*2,o=Math.random()*15,u=e+Math.cos(i)*o,c=n+Math.sin(i)*o;T.push(new ge(u,c,t))}},un=()=>{if(me.fillStyle="white",me.fillRect(0,0,N.width,N.height),ae){let t=D.get().spawnType;ie(be,ke,w.spawnRate,t)}T=T.filter(t=>t.update(N));let e=0;for(let t=0;t<T.length;t++)for(let l=t+1;l<T.length;l++)T[t].checkCollision(T[l])&&e++;q.push(e),q.length>60&&q.shift();let n=q.reduce((t,l)=>t+l,0);T.forEach(t=>t.draw(me));let r=T.length>0?T.reduce((t,l)=>t+l.getSpeed(),0)/T.length:0;D.set({total:T.length,velocity:r,collisions:n},{silent:!0}),requestAnimationFrame(un)};D.subscribe((e,n)=>{e in w&&(w[e]=n)});var Zn="slow";D.subscribe("spawnType",e=>{Zn=e});D.subscribe("burst",()=>{ln();let e=N.width/2,n=N.height/2,r=Math.floor(w.burstSize/3);ie(e,n,r,"slow"),ie(e,n,r,"fast"),ie(e,n,r,"heavy")});D.subscribe("reset",()=>{T=[],q=[],w.gravity=.1,w.bounce=.8,w.friction=.99,w.spawnRate=2,w.burstSize=50,D.set({gravity:.1,bounce:.8,friction:.99,spawnRate:2,spawnType:"slow"})});var sn=e=>{ln(),ae=!0;let n=on(e);be=n.x,ke=n.y},cn=e=>{if(!ae)return;e.preventDefault();let n=on(e);be=n.x,ke=n.y},oe=()=>{ae=!1};N.addEventListener("mousedown",sn);N.addEventListener("mousemove",cn);N.addEventListener("mouseup",oe);N.addEventListener("mouseout",oe);N.addEventListener("touchstart",sn,{passive:!1});N.addEventListener("touchmove",cn,{passive:!1});N.addEventListener("touchend",oe);N.addEventListener("touchcancel",oe);window.addEventListener("resize",an);an();un();
